<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition>

	<!-- @param commentEntity. Comment -->
	<ui:param name="modalId" value="#{ commentEntity.id }"></ui:param>
	
			<h:panelGroup rendered="#{ !commentEntity.hidden }">
			
				<div class="comment-box">
					
					<b>#{ commentEntity.text }</b>  <p> #{ commentEntity.user.fullName }</p>
					<h:panelGroup rendered="#{not empty commentEntity.lastUpdated }">
						<i>Last updated: #{commentEntity.lastUpdated}</i>
					</h:panelGroup>									 

					<h:panelGroup rendered="#{ commentEntity.user.email eq loginUserBean.user.email}">
						<h:form id="update_comment">
							<h:messages>
								<h:message for="update_comment"></h:message>
							</h:messages>
							
							<h:panelGrid columns="2" cellpadding="5">	
							<img src="remove.png"></img>
								<h:commandButton class="btn" action="#{ deleteCommentBean.submit() }" value="Delete">
	    							<f:setPropertyActionListener target="#{ deleteCommentBean.selectedCommentId }" value="#{ commentEntity.id }"/>								
									<f:param name="id" value="#{ commentEntity.post.id }"/>
								</h:commandButton>			
							</h:panelGrid>	
							
						</h:form>	   
					</h:panelGroup>

					<p:commandButton class="btn" rendered="#{ commentEntity.user.email eq loginUserBean.user.email }" value="Update" type="button" onclick="PF(#{ modalId }).show();" />
					<p:dialog header="Update comment" widgetVar="#{ modalId }" modal="true" height="300">

						<form action="/clubproject/update-comment" method="post">
							<input type="hidden" name="comment_id" value="#{ commentEntity.id }"/>
							<textarea name="text">#{ commentEntity.text }</textarea>
							<input type="submit" value="Update comment"/>
						</form> 
	
						
					</p:dialog>	
				</div>
				
			</h:panelGroup>
</ui:composition>

</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition>

	<!-- @param commentEntity. Comment -->
	<ui:param name="modalId" value="#{ commentEntity.id }"></ui:param>
	
			<h:panelGroup rendered="#{ !commentEntity.hidden }">
			
				<div>
					<hr></hr>			
					<b>#{ commentEntity.text }</b>  <p> #{ commentEntity.user.fullName }</p>
									 
					<p:commandButton rendered="#{ commentEntity.user.email eq loginUserBean.user.email }" value="Update" type="button" onclick="PF(#{ modalId }).show();" />
					<p:dialog header="Update comment" widgetVar="#{ modalId }" modal="true" height="300">

						<form action="/clubproject/update-comment" method="post">
							<input type="hidden" name="comment_id" value="#{ commentEntity.id }"/>
							<textarea name="text">#{ commentEntity.text }</textarea>
							<input type="submit" value="Update comment"/>
						</form> 
	
						<h:form id="update_comment">
							<h:messages>
								<h:message for="update_comment"></h:message>
							</h:messages>
							
							<h:panelGrid columns="2" cellpadding="5">	
								<h:commandButton action="#{ deleteCommentBean.submit }" value="Delete">
	    							<f:setPropertyActionListener target="#{ commentBean.selectedCommentId }" value="#{ commentEntity.id }"/>								
								</h:commandButton>			
							</h:panelGrid>	
							
						</h:form>	   
						
					</p:dialog>	
				</div>
				
			</h:panelGroup>
</ui:composition>

</html>
